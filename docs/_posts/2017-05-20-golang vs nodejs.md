---
layout: post
title: go会战胜nodejs吗？
categories: golang
description:  最新最热门的几种计算机编程语言中go和nodejs也算其中的一种，总的来说两门语言都有各自的优点，但我就我个人体验来看，我倾向于go。可能个人比较喜欢静态编译型语言吧，但不可否认，解释型语言在某些时候真的很有优势。
keywords: golang, nodejs ,比较
---

## 2017-05-20-go会战胜nodejs吗？

### 1.综述
最新最热门的几种计算机编程语言中go和nodejs也算其中的一种，总的来说两门语言都有各自的优点，但我就我个人体验来看，我倾向于go。可能个人比较喜欢静态编译型语言吧，但不可否认，解释型语言在某些时候真的很有优势。下面我就几个方面来说说它们各自的优缺点。

### 2.运行速度比较
nodejs是一个很神奇的东西，明明是一种解释型语言（它以javascript为基础），但运行速度却很快。尤其是它的回调方式编程架构，在某些方面可以让计算机发挥100%的能力。听人说nodejs的http服务能力比go强很多，所以我也测试了一下，发现远不是如此。
本次测试go版本1.6，nodejs版本5.0.0，测试平台：windows7 64位旗舰版。硬件：CPUI7 4700，内存4G
go测试代码如下：
```
package main

import (
	"fmt"
	"log"
	"net/http"
	"runtime"
)

func main() {
	// 因为nodejs是单线程架构，为公平起见，限制为1个CPU
	runtime.GOMAXPROCS(1)

	http.HandleFunc("/", func(w http.ResponseWriter, r *http.Request) {
		fmt.Fprint(w, "Hello, world.")
	})

	log.Fatal(http.ListenAndServe(":8080", nil))
}
```
nodejs的测试代码如下：
```
var http = require('http');
http.createServer(function (req, res) {
    res.end('Hello, World.');
}).listen(8080, '127.0.0.1');
console.log('Server running at http://127.0.0.1:8080/');
```
分别用ab来进行压测：
ab -c 100 -n 5000 http://127.0.0.1:8080/
结果出乎我的意料，go版服务requests per second有6900多，而nodejs的只有4400多，可见两都有明显的差距，而且我们知道go可以轻松的使用多核CPU，而nodejs就麻烦多了。在这一点上，go稍占优势。但这并不是最最重要的。请各位继续看。


### 3.模块数量及扩展性
两门语言的推出时间差不多，都是在2009年出现的，可以说是非常新的语言。但不知道是什么原因，nodejs的社区活跃度非常高，可用的高质量的模块非常多，你可以在guthub上轻松找到你想要的模块。但go语言就差一些了，虽然有个google的老爹，但发展着实让人着急，1.0之前的go可以说性能比较差，发展到现在1.6，性能已经有了飞跃，发展也渐渐的快起来了，但不管怎么说，它的模块数量和nodejs是无法比的。在这方面来说nodejs占有比较大的优势。
而且两者都可以用C语言来进行扩展，但扩展编写的难易程度而言，go语言要强很多，它的cgo机制可以直接嵌入c代码，还有比这更强的的吗？所以go可以轻松的使用很多c写的库。扩展性方面go稍占优势。

### 4.编程难易程度
因为我也只是粗略的学习使用了两种语言，无法深度体会两种语言的精髓。就表面来看，我比较喜欢go一些，因为它的一些语法正是我想要的，比如：赋值时省略var和变量类型，比如第一个大括号要写在后面，比如它内置的slice、map，比如它的协程用法，都是有创新性的一些改变。nodejs由于使用chrome的v8引擎，所以它使用的是javascript语言，这个语言是一种非常灵活的语言，作为浏览器操作语言，我认为那是太合适了，但作为服务器语言，很多方面还是有欠缺的，比如：代码难以组织（node发展出了模块）、this指针会随上下文变化（node发展了=>操作符以锁定上下文）、回调机制让编程变的困难。但由于有前后端都用javascript这个噱头（要用node，可不只是会前端就可以的，还要学好多呢，只是省略了语言的上下文切换），所以很多人都上个这个船。

### 5.我为什么推荐go
总的来说node会的，go也会，而go会的，node并不会，所以我们为什么不使用go呢？当然作为解释语言，还是有优点的，比如有很多主机可以支持node代码，但并不支持用go编译一个可执行文件。但现在vps这么便宜，为什么不用它呢？我觉得node的主要问题的程序的健壮程度实在不够，很多原因都会引起程序的CASH，内存是v8引擎管理的，在32位操作系统上有800m的限制，在64位系统上有1600M的限制，超出内存限制也会崩溃掉，javascript的调试那就是一个灾难。这方面go语言就会好的多，内存的限制是不存在的，错误处理也非常正规（返回一个错误信息），也有延迟执行用于释放资源（defer）。所以大型程序最好用go语言构建，它的调试也非常方便。