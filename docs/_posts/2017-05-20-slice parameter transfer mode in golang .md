---
layout: post
title: golang中slice参数的传递方式
categories: golang
description: 我们在使用golang时，经常看到书上这样写：“一般类型、结构体、数组在作为函数参数时，都是值传递，而slice和map是引用传递。”真的是这样吗？我想我们有必要进行一下自己的实验。
keywords: golang, slice ,参数传递
---

## golang中slice参数的传递方式

我们在使用golang时，经常看到书上这样写：“一般类型、结构体、数组在作为函数参数时，都是值传递，而slice和map是引用传递。”真的是这样吗？我想我们有必要进行一下自己的实验。我设计了以下程序以验证上面的说法：
```
package main

import (
	"fmt"
)

type Demo struct {
	a        int
	user_pai [][]int
	m        [200]int
}

func main() {
	var d Demo
	d.user_pai = make([][]int, 4) //用户牌型空间初始化
	for i := 0; i < 4; i++ {
		d.user_pai[i] = make([]int, 14)
	}
	d.a = 90
	d.m[0] = 111
	fmt.Printf("%p\n", &d)
	fmt.Printf("%p\n", d.user_pai)
	xx(d)
	fmt.Println(d)
}

func xx(dd Demo) {
	fmt.Printf("%p\n", &dd)
	fmt.Printf("%p\n", dd.user_pai)
	dd.a = 888
	dd.user_pai[0][0] = 100
	dd.m[0] = 333
}
```
### 输出结果如下：
```
0x1074a380
0x10756030
0x1074a700
0x10756030
{90 [[100 0 0 0 0 0 0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0 0 0 0 0 0 0] [0 0 0 0 0 0 0 0 0 0 0 0 0 0]] [111 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]}
```

### 结论
从上面的输出可见，在函数传参时，结构体的确进行了复制，数组也进行了复制，而slice在结构体中的确存放的是指针。这个结论和某些语言可能有些不同，在其它一些语言中，数组一般也是引用传递的，但在golang中很明显不是。就像上面输出结果中的111，它并没有变化为333。